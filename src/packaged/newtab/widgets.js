const WIDGET_TYPES={timeAndWeather:{title:"Time & Weather",widgets:{analogClock:{id:"analog-clock",name:"Analog Clock",icon:"🕒",description:"Displays an analog clock"},digitalClock:{id:"digital-clock",name:"Digital Clock",icon:"⏰",description:"Displays time in digital format"},weather:{id:"weather",name:"Weather",icon:"☁️",description:"Shows current weather conditions"},worldClock:{id:"world-clock",name:"World Clock",icon:"🌐",description:"Displays time in different time zones"}}},productivity:{title:"Productivity",widgets:{todo:{id:"todo",name:"To-Do List",icon:"✓",description:"Manage your tasks"},notes:{id:"notes",name:"Quick Notes",icon:"📝",description:"Write and save notes"},calendar:{id:"calendar",name:"Calendar",icon:"📅",description:"View upcoming events"},timer:{id:"timer",name:"Timer",icon:"⏱️",description:"Set timers and alarms"},pomodoro:{id:"pomodoro",name:"Pomodoro Timer",icon:"🍅",description:"Focus timer with breaks"}}},information:{title:"Information",widgets:{news:{id:"news",name:"News Headlines",icon:"📰",description:"Latest news headlines"},stocks:{id:"stocks",name:"Stocks",icon:"📈",description:"Stock prices and trends"},quote:{id:"quote",name:"Inspirational Quote",icon:"💬",description:"Random inspirational quotes"},rss:{id:"rss",name:"RSS Feed",icon:"📡",description:"Custom RSS feed reader"}}},media:{title:"Media",widgets:{music:{id:"music-controls",name:"Music Controls",icon:"🎵",description:"Control music playback"},bookmarks:{id:"bookmarks",name:"Bookmarks",icon:"🔖",description:"Quick access to bookmarks"},recentlyVisited:{id:"recently-visited",name:"Recently Visited",icon:"🕒",description:"Recently visited websites"}}}};function createWidget(e){const t=document.createElement("div");t.className="widget",t.id=`widget-${e.widgetType}-${Date.now()}`;const n="function"==typeof calculatePosition?calculatePosition(e.x||50,e.y||50):{percentX:.5,percentY:.5};if(t.style.position="absolute",t.style.top=100*n.percentY+"%",t.style.left=100*n.percentX+"%",t.style.transform="translate(-50%, -50%)",e.title){const n=document.createElement("div");n.className="widget-header",n.textContent=e.title,t.appendChild(n)}const o=document.createElement("div");switch(o.className="widget-content",e.widgetType){case"analog-clock":setupAnalogClockWidget(o,e);break;case"digital-clock":setupDigitalClockWidget(o,e);break;case"weather":setupWeatherWidget(o,e);break;case"world-clock":setupWorldClockWidget(o,e);break;case"todo":setupTodoWidget(o,e);break;case"notes":setupNotesWidget(o,e);break;case"calendar":setupCalendarWidget(o,e);break;case"timer":setupTimerWidget(o,e);break;case"pomodoro":setupPomodoroWidget(o,e);break;case"quote":setupQuoteWidget(o,e);break;case"news":setupNewsWidget(o,e);break;case"stocks":setupStocksWidget(o,e);break;case"rss":setupRssWidget(o,e);break;case"music-controls":setupMusicWidget(o,e);break;case"bookmarks":setupBookmarksWidget(o,e);break;case"recently-visited":setupRecentlyVisitedWidget(o,e);break;default:o.innerHTML=`<div class="widget-placeholder">\n                <div class="widget-icon">${e.icon||"🔧"}</div>\n                <div>Widget: ${e.title||e.widgetType}</div>\n            </div>`}return t.appendChild(o),t}function setupAnalogClockWidget(e,t){e.className="widget-content clock-widget analog-clock";const n=document.createElement("div");n.className="clock-face";for(let e=1;e<=12;e++){const t=document.createElement("div");t.className="hour-marker";const o=30*e-90,a=80*Math.cos(o*Math.PI/180),i=80*Math.sin(o*Math.PI/180);t.style.left=`calc(50% + ${a}px)`,t.style.top=`calc(50% + ${i}px)`,t.textContent=e,n.appendChild(t)}const o=document.createElement("div");o.className="clock-hand hour-hand";const a=document.createElement("div");a.className="clock-hand minute-hand";const i=document.createElement("div");i.className="clock-hand second-hand";const r=document.createElement("div");r.className="center-dot";const c=t.settings?.timezone||"local";let d=null;if("local"!==c){d=document.createElement("div"),d.className="timezone-label";const t={"America/New_York":"New York","America/Los_Angeles":"Los Angeles","Europe/London":"London","Europe/Paris":"Paris","Asia/Tokyo":"Tokyo"};d.textContent=t[c]||c,e.appendChild(d)}function s(){const e=new Date;let t,n,r;if("local"===c)t=e.getHours()%12,n=e.getMinutes(),r=e.getSeconds();else{const o={timeZone:c,hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"};try{const a=e.toLocaleTimeString("en-US",o),[i,c]=a.split(" "),[d,s,l]=i.split(":").map((e=>parseInt(e,10)));t=d%12,n=s,r=l}catch(o){console.error("Error formatting time for timezone:",o),t=e.getHours()%12,n=e.getMinutes(),r=e.getSeconds()}}const d=30*t+.5*n,s=6*n,l=6*r;o.style.transform=`translateX(-50%) rotate(${d}deg)`,a.style.transform=`translateX(-50%) rotate(${s}deg)`,i.style.transform=`translateX(-50%) rotate(${l}deg)`}n.appendChild(o),n.appendChild(a),n.appendChild(i),n.appendChild(r),e.appendChild(n),s();const l=setInterval(s,1e3);e.dataset.intervalId=l;const p=document.createElement("style");p.textContent="\n    .analog-clock {\n        width: 200px;\n        height: 200px;\n        padding: 10px;\n        position: relative;\n    }\n    .clock-face {\n        width: 100%;\n        height: 100%;\n        border-radius: 50%;\n        position: relative;\n        background-color: var(--group-background-color, #f5f5f5);\n        box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1), 0 0 10px rgba(0, 0, 0, 0.2);\n    }\n    .hour-marker {\n        position: absolute;\n        font-weight: bold;\n        font-size: 14px;\n        transform: translate(-50%, -50%);\n        color: var(--text-color, #333);\n    }\n    .clock-hand {\n        position: absolute;\n        bottom: 50%;\n        left: 50%;\n        transform-origin: bottom;\n        background-color: var(--text-color, #333);\n    }\n    .hour-hand {\n        width: 6px;\n        height: 50px;\n        border-radius: 3px;\n    }\n    .minute-hand {\n        width: 4px;\n        height: 70px;\n        border-radius: 2px;\n    }\n    .second-hand {\n        width: 2px;\n        height: 80px;\n        background-color: var(--accent-color, #f00);\n        border-radius: 1px;\n    }\n    .center-dot {\n        position: absolute;\n        width: 12px;\n        height: 12px;\n        background-color: var(--text-color, #333);\n        border-radius: 50%;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n    }\n    .timezone-label {\n        position: absolute;\n        bottom: 5px;\n        left: 50%;\n        transform: translateX(-50%);\n        font-size: 12px;\n        color: var(--text-color, #333);\n        opacity: 0.7;\n        text-align: center;\n        font-style: italic;\n    }\n    ",document.head.appendChild(p)}function setupDigitalClockWidget(e,t){e.className="widget-content clock-widget digital-clock";const n=document.createElement("div");n.className="time-display";const o=document.createElement("div");o.className="date-display";const a=document.createElement("div");a.className="timezone-display",e.appendChild(n),e.appendChild(o),e.appendChild(a);const i=t.settings?.timeFormat||"24h",r=!1!==t.settings?.showSeconds,c=!1!==t.settings?.showDate,d=t.settings?.timezone||"local",s={local:"Local Time","America/New_York":"New York","America/Los_Angeles":"Los Angeles","Europe/London":"London","Europe/Paris":"Paris","Asia/Tokyo":"Tokyo"};function l(){const e=new Date;let t;if("local"===d)t=e;else{const n={timeZone:d,hour12:!1};try{const o=e.toLocaleTimeString("en-US",n),[a,i]=o.split(" "),[r,c,d]=a.split(":").map((e=>parseInt(e,10)));t=new Date,t.setHours(r),t.setMinutes(c),t.setSeconds(d)}catch(n){console.error("Error formatting time for timezone:",n),t=e}}let a=t.getHours();const s=t.getMinutes().toString().padStart(2,"0"),l=t.getSeconds().toString().padStart(2,"0");let p,m="";if("12h"===i?(m=a>=12?" PM":" AM",a%=12,a=a||12,p=`${a}:${s}${r?":"+l:""}${m}`):(a=a.toString().padStart(2,"0"),p=`${a}:${s}${r?":"+l:""}`),n.textContent=p,c){let t={weekday:"long",year:"numeric",month:"long",day:"numeric"};"local"!==d&&(t.timeZone=d),o.textContent=e.toLocaleDateString(void 0,t),o.style.display="block"}else o.style.display="none"}"local"!==d?(a.textContent=s[d]||d,a.style.display="block"):a.style.display="none",l();const p=setInterval(l,1e3);e.dataset.intervalId=p;const m=document.createElement("style");m.textContent="\n    .digital-clock {\n        width: 230px;\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        text-align: center;\n        background-color: var(--group-background-color, #f5f5f5);\n        border-radius: 10px;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        color: var(--text-color, #333);\n    }\n    .time-display {\n        font-size: 36px;\n        font-weight: bold;\n        margin-bottom: 5px;\n        font-family: 'Courier New', monospace;\n        color: var(--text-color, #333);\n    }\n    .date-display {\n        font-size: 14px;\n        color: var(--text-color, #333);\n        opacity: 0.7;\n    }\n    .timezone-display {\n        font-size: 12px;\n        color: var(--text-color, #333);\n        opacity: 0.7;\n        margin-top: 5px;\n        font-style: italic;\n    }\n    ",document.head.appendChild(m)}function setupWeatherWidget(e,t){e.className="widget-content weather-widget";const n=document.createElement("div");n.className="current-conditions";const o=document.createElement("div");o.className="temperature";const a=document.createElement("div");a.className="condition";const i=document.createElement("div");i.className="location";const r=document.createElement("div");r.className="status",r.textContent="Loading weather...",e.appendChild(n),e.appendChild(o),e.appendChild(a),e.appendChild(i),e.appendChild(r);const c=t.settings?.units||"imperial";fetchWeatherData(t.settings?.location||"auto",c).then((e=>{e?(o.textContent=`${Math.round(e.temp)}°${"metric"===c?"C":"F"}`,a.textContent=e.condition,n.textContent=getWeatherIcon(e.conditionCode),i.textContent=e.location,r.style.display="none",o.style.display="block",a.style.display="block",n.style.display="block",i.style.display="block"):(r.textContent="Unable to load weather data",r.style.color="var(--accent-color, #ff5555)")})).catch((e=>{console.error("Weather widget error:",e),r.textContent="Error loading weather data",r.style.color="var(--accent-color, #ff5555)"}));const d=document.createElement("style");d.textContent="\n    .weather-widget {\n        width: 200px;\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        background-color: var(--group-background-color, #f5f5f5);\n        border-radius: 10px;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        color: var(--text-color, #333);\n    }\n    .current-conditions {\n        font-size: 48px;\n        margin-bottom: 10px;\n        display: none;\n    }\n    .temperature {\n        font-size: 36px;\n        font-weight: bold;\n        margin-bottom: 5px;\n        display: none;\n        color: var(--text-color, #333);\n    }\n    .condition {\n        font-size: 18px;\n        margin-bottom: 10px;\n        display: none;\n        color: var(--text-color, #333);\n    }\n    .location {\n        font-size: 14px;\n        color: var(--text-color, #333);\n        opacity: 0.7;\n        display: none;\n    }\n    .status {\n        font-size: 14px;\n        color: var(--text-color, #333);\n        opacity: 0.7;\n        margin-top: 10px;\n    }\n    ",document.head.appendChild(d)}async function fetchWeatherData(e,t){try{let n,o;const a="37c1133b7ad6d2fa28b0af3aab4e42af";if("auto"===e)try{const e=await getCurrentPosition();n=e.coords.latitude,o=e.coords.longitude}catch(e){console.warn("Geolocation failed, using default location:",e),n=40.7128,o=-74.006}else if(/^\d{5}(-\d{4})?$/.test(e)){const t=await fetch(`https://api.openweathermap.org/geo/1.0/zip?zip=${e},US&appid=${a}`);if(!t.ok)throw new Error("Failed to get location data from zip code");const i=await t.json();n=i.lat,o=i.lon}else{const t=await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(e)}&limit=1&appid=${a}`);if(!t.ok)throw new Error("Failed to get location data from city name");const i=await t.json();if(0===i.length)throw new Error("Location not found");n=i[0].lat,o=i[0].lon}const i=await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${n}&lon=${o}&units=${t}&appid=${a}`);if(!i.ok)throw new Error("Failed to fetch weather data");const r=await i.json();return{temp:r.main.temp,condition:r.weather[0].main,conditionCode:r.weather[0].id,location:r.name}}catch(e){return console.error("Error fetching weather data:",e),{temp:72,condition:"Clear",conditionCode:800,location:"New York, NY"}}}function getCurrentPosition(){return new Promise(((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5}):t(new Error("Geolocation not supported"))}))}function getWeatherIcon(e){return e>=200&&e<300?"⛈️":e>=300&&e<400||e>=500&&e<600?"🌧️":e>=600&&e<700?"❄️":e>=700&&e<800?"🌫️":800===e?"☀️":e>800?"☁️":"🌡️"}function setupWorldClockWidget(e,t){e.className="widget-content world-clock-widget";const n=t.settings?.timezones||[{name:"New York",timezone:"America/New_York"},{name:"London",timezone:"Europe/London"},{name:"Tokyo",timezone:"Asia/Tokyo"}],o=document.createElement("div");function a(){const t=e.querySelectorAll(".time-display"),n=new Date;t.forEach((e=>{const t=e.dataset.timezone;try{const o={hour:"2-digit",minute:"2-digit",timeZone:t};e.textContent=n.toLocaleTimeString(void 0,o)}catch(t){e.textContent="Invalid timezone"}}))}o.className="clocks-container",n.forEach((e=>{const t=document.createElement("div");t.className="clock-item";const n=document.createElement("div");n.className="city-name",n.textContent=e.name;const a=document.createElement("div");a.className="time-display",a.dataset.timezone=e.timezone,t.appendChild(n),t.appendChild(a),o.appendChild(t)})),e.appendChild(o),a();const i=setInterval(a,6e4);e.dataset.intervalId=i;const r=document.createElement("style");r.textContent="\n    .world-clock-widget {\n        width: 200px;\n        padding: 15px;\n        background-color: var(--group-background-color, #f5f5f5);\n        border-radius: 10px;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        color: var(--text-color, #333);\n    }\n    .clocks-container {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n    .clock-item {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 5px 0;\n        border-bottom: 1px solid var(--text-color, rgba(0, 0, 0, 0.1));\n        border-bottom-color: rgba(var(--text-color, 0, 0, 0), 0.1);\n    }\n    .clock-item:last-child {\n        border-bottom: none;\n    }\n    .city-name {\n        font-weight: bold;\n        color: var(--text-color, #333);\n    }\n    .time-display {\n        font-family: 'Courier New', monospace;\n        color: var(--text-color, #333);\n    }\n    ",document.head.appendChild(r)}function setupTodoWidget(e,t){e.className="widget-content todo-widget";const n=document.createElement("ul");n.className="todo-list";const o=document.createElement("div");o.className="todo-input-container";const a=document.createElement("input");a.type="text",a.placeholder="Add a new task...",a.className="todo-input";const i=document.createElement("button");i.className="add-todo-button",i.textContent="+",o.appendChild(a),o.appendChild(i),e.appendChild(n),e.appendChild(o);const r=t.settings?.todos||[];function c(){n.innerHTML="",r.forEach(((e,t)=>{const o=document.createElement("li");o.className="todo-item",e.completed&&o.classList.add("completed");const a=document.createElement("input");a.type="checkbox",a.checked=e.completed,a.addEventListener("change",(()=>function(e){e>=0&&e<r.length&&(r[e].completed=!r[e].completed,c())}(t)));const i=document.createElement("span");i.textContent=e.text,i.className="todo-text";const d=document.createElement("button");d.className="delete-todo",d.textContent="×",d.addEventListener("click",(()=>function(e){e>=0&&e<r.length&&(r.splice(e,1),c())}(t))),o.appendChild(a),o.appendChild(i),o.appendChild(d),n.appendChild(o)})),function(){t.settings||(t.settings={});t.settings.todos=r}()}function d(){const e=a.value.trim();e&&(r.push({text:e,completed:!1}),a.value="",c())}c(),i.addEventListener("click",d),a.addEventListener("keypress",(function(e){"Enter"===e.key&&d()}));const s=document.createElement("style");s.textContent='\n    .todo-widget {\n        width: 250px;\n        padding: 15px;\n        background-color: var(--group-background-color, #f5f5f5);\n        border-radius: 10px;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        color: var(--text-color, #333);\n    }\n    .todo-list {\n        list-style: none;\n        padding: 0;\n        margin: 0 0 10px 0;\n        max-height: 200px;\n        overflow-y: auto;\n    }\n    .todo-item {\n        display: flex;\n        align-items: center;\n        padding: 8px 0;\n        border-bottom: 1px solid var(--text-color, rgba(0, 0, 0, 0.1));\n        border-bottom-color: rgba(var(--text-color, 0, 0, 0), 0.1);\n    }\n    .todo-item.completed .todo-text {\n        text-decoration: line-through;\n        opacity: 0.6;\n    }\n    .todo-item input[type="checkbox"] {\n        margin-right: 10px;\n    }\n    .todo-text {\n        flex: 1;\n        color: var(--text-color, #333);\n    }\n    .delete-todo {\n        background: none;\n        border: none;\n        color: var(--accent-color, #ff5555);\n        font-size: 18px;\n        cursor: pointer;\n        padding: 0 5px;\n    }\n    .todo-input-container {\n        display: flex;\n        margin-top: 10px;\n    }\n    .todo-input {\n        flex: 1;\n        padding: 8px;\n        border: 1px solid var(--group-background-color, #ddd);\n        border-radius: 4px 0 0 4px;\n        color: var(--text-color, #333);\n        background-color: var(--all-background-color, #fff);\n    }\n    .add-todo-button {\n        background-color: var(--primary-color, #4caf50);\n        color: var(--contrast-text-color, white);\n        border: none;\n        padding: 8px 12px;\n        border-radius: 0 4px 4px 0;\n        cursor: pointer;\n    }\n    ',document.head.appendChild(s)}function setupNotesWidget(e,t){e.className="widget-content notes-widget";const n=document.createElement("div");n.className="notes-content";const o=document.createElement("textarea");let a;function i(){const e=o.value;t.settings||(t.settings={}),t.settings.notes=e}o.className="notes-textarea",o.placeholder="Write your notes here...",t.settings?.notes&&(o.value=t.settings.notes),n.appendChild(o),e.appendChild(n),o.addEventListener("input",(()=>{clearTimeout(a),a=setTimeout(i,1e3)}));const r=document.createElement("style");r.textContent="\n    .notes-widget {\n        width: 250px;\n        padding: 15px;\n        background-color: var(--group-background-color, #f5f5f5);\n        border-radius: 10px;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        color: var(--text-color, #333);\n    }\n    .notes-content {\n        width: 100%;\n    }\n    .notes-textarea {\n        width: 100%;\n        height: 150px;\n        padding: 10px;\n        border: 1px solid var(--group-background-color, #ddd);\n        border-radius: 5px;\n        resize: none;\n        font-family: inherit;\n        background-color: var(--all-background-color, #fff);\n        color: var(--text-color, #333);\n    }\n    ",document.head.appendChild(r)}function setupQuoteWidget(e,t){e.className="widget-content quote-widget";const n=document.createElement("div");n.className="quote-text";const o=document.createElement("div");o.className="quote-author";const a=document.createElement("button");a.className="refresh-quote",a.innerHTML="↻",a.title="New Quote",e.appendChild(n),e.appendChild(o),e.appendChild(a);const i=[{text:"The only way to do great work is to love what you do.",author:"Steve Jobs"},{text:"Life is what happens when you're busy making other plans.",author:"John Lennon"},{text:"The future belongs to those who believe in the beauty of their dreams.",author:"Eleanor Roosevelt"},{text:"It does not matter how slowly you go as long as you do not stop.",author:"Confucius"},{text:"Success is not final, failure is not fatal: It is the courage to continue that counts.",author:"Winston Churchill"}];function r(){const e=Math.floor(Math.random()*i.length),t=i[e];n.textContent=`"${t.text}"`,o.textContent=`- ${t.author}`}r(),a.addEventListener("click",r);const c=document.createElement("style");c.textContent="\n    .quote-widget {\n        width: 250px;\n        padding: 20px;\n        background-color: var(--group-background-color, #f5f5f5);\n        border-radius: 10px;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        position: relative;\n        color: var(--text-color, #333);\n    }\n    .quote-text {\n        font-style: italic;\n        margin-bottom: 10px;\n        line-height: 1.4;\n        color: var(--text-color, #333);\n    }\n    .quote-author {\n        text-align: right;\n        opacity: 0.7;\n        font-size: 0.9em;\n        color: var(--text-color, #333);\n    }\n    .refresh-quote {\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        background: none;\n        border: none;\n        font-size: 16px;\n        cursor: pointer;\n        color: var(--text-color, #777);\n        opacity: 0.7;\n    }\n    .refresh-quote:hover {\n        color: var(--text-color, #333);\n        opacity: 1;\n    }\n    ",document.head.appendChild(c)}function setupCalendarWidget(e,t){e.className="widget-content calendar-widget";const n=document.createElement("div");n.className="calendar-header";const o=document.createElement("button");o.className="month-nav prev-month",o.innerHTML="&lt;";const a=document.createElement("div");a.className="month-display";const i=document.createElement("button");i.className="month-nav next-month",i.innerHTML="&gt;",n.appendChild(o),n.appendChild(a),n.appendChild(i);const r=document.createElement("div");r.className="weekday-header";["Su","Mo","Tu","We","Th","Fr","Sa"].forEach((e=>{const t=document.createElement("div");t.className="weekday",t.textContent=e,r.appendChild(t)}));const c=document.createElement("div");c.className="calendar-grid",e.appendChild(n),e.appendChild(r),e.appendChild(c);let d=new Date;function s(){a.textContent=d.toLocaleDateString("default",{month:"long",year:"numeric"}),c.innerHTML="";const e=new Date(d.getFullYear(),d.getMonth(),1),t=new Date(d.getFullYear(),d.getMonth()+1,0),n=e.getDay();for(let e=0;e<n;e++){const e=document.createElement("div");e.className="day empty",c.appendChild(e)}const o=new Date;for(let e=1;e<=t.getDate();e++){const t=document.createElement("div");t.className="day",t.textContent=e,o.getDate()===e&&o.getMonth()===d.getMonth()&&o.getFullYear()===d.getFullYear()&&t.classList.add("today"),c.appendChild(t)}}s(),o.addEventListener("click",(()=>{d=new Date(d.getFullYear(),d.getMonth()-1,1),s()})),i.addEventListener("click",(()=>{d=new Date(d.getFullYear(),d.getMonth()+1,1),s()}));const l=document.createElement("style");l.textContent="\n    .calendar-widget {\n        width: 280px;\n        padding: 15px;\n        background-color: var(--group-background-color, #f5f5f5);\n        border-radius: 10px;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        color: var(--text-color, #333);\n    }\n    .calendar-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 10px;\n    }\n    .month-display {\n        font-weight: bold;\n        text-align: center;\n        flex: 1;\n        color: var(--text-color, #333);\n    }\n    .month-nav {\n        background: none;\n        border: none;\n        font-size: 18px;\n        cursor: pointer;\n        padding: 0 10px;\n        color: var(--text-color, #333);\n    }\n    .weekday-header {\n        display: grid;\n        grid-template-columns: repeat(7, 1fr);\n        text-align: center;\n        font-weight: bold;\n        margin-bottom: 5px;\n    }\n    .weekday {\n        padding: 5px;\n        color: var(--text-color, #333);\n    }\n    .calendar-grid {\n        display: grid;\n        grid-template-columns: repeat(7, 1fr);\n        gap: 2px;\n    }\n    .day {\n        aspect-ratio: 1;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border-radius: 50%;\n        transition: background-color 0.2s;\n        color: var(--text-color, #333);\n    }\n    .day:hover {\n        background-color: var(--text-color, rgba(0, 0, 0, 0.1));\n        background-color: rgba(var(--text-color, 0, 0, 0), 0.1);\n        cursor: pointer;\n    }\n    .day.empty {\n        background: none;\n    }\n    .day.today {\n        background-color: var(--primary-color, #4285f4);\n        color: var(--contrast-text-color, white);\n    }\n    ",document.head.appendChild(l)}function setupTimerWidget(e,t){e.className="widget-content timer-widget";const n={time:0,isRunning:!1,interval:null},o=document.createElement("div");o.className="timer-display",o.textContent="00:00:00";const a=document.createElement("div");a.className="timer-controls";const i=document.createElement("button");i.className="timer-button start",i.textContent="Start";const r=document.createElement("button");r.className="timer-button reset",r.textContent="Reset";const c=document.createElement("div");c.className="timer-presets";function d(){const e=Math.floor(n.time/3600),t=Math.floor(n.time%3600/60),a=n.time%60;o.textContent=[e.toString().padStart(2,"0"),t.toString().padStart(2,"0"),a.toString().padStart(2,"0")].join(":")}function s(){n.isRunning=!0,i.textContent="Pause",i.classList.remove("start"),i.classList.add("pause"),n.interval=setInterval((()=>{n.time>0?(n.time--,d()):(l(),function(){o.classList.add("timer-complete"),setTimeout((()=>{o.classList.remove("timer-complete")}),3e3);try{new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLHPM+N2fUBEGJV+68fPWt2gdAiFAlNjw7M6jdTEGGzJkpOXz8d7GoFEQBRUlU4293PXx6ox5SxMIESlJdavQ7/n41rSARB0HEyMvW3eVs+L78O/GmFwzDAcaJTFDXXOPs/L67+PCnWZBFQUSHyo3PUlacJXA+PfrzLaFUSkIChUlMDU4PUdT").play()}catch(e){console.log("Audio notification not supported")}}())}),1e3)}function l(){n.isRunning=!1,i.textContent="Start",i.classList.remove("pause"),i.classList.add("start"),clearInterval(n.interval)}[{label:"5m",seconds:300},{label:"10m",seconds:600},{label:"25m",seconds:1500}].forEach((e=>{const t=document.createElement("button");t.className="preset-button",t.textContent=e.label,t.addEventListener("click",(()=>{n.time=e.seconds,d(),l()})),c.appendChild(t)})),a.appendChild(i),a.appendChild(r),e.appendChild(o),e.appendChild(a),e.appendChild(c),i.addEventListener("click",(()=>{n.isRunning?l():s()})),r.addEventListener("click",(function(){l(),n.time=0,d()}));const p=document.createElement("style");p.textContent="\n    .timer-widget {\n        width: 230px;\n        padding: 15px;\n        background-color: var(--group-background-color, #f5f5f5);\n        border-radius: 10px;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        text-align: center;\n        color: var(--text-color, #333);\n    }\n    .timer-display {\n        font-size: 32px;\n        font-family: 'Courier New', monospace;\n        margin-bottom: 15px;\n        padding: 10px;\n        background-color: var(--all-background-color, #fff);\n        border-radius: 5px;\n        box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);\n        color: var(--text-color, #333);\n    }\n    .timer-controls {\n        display: flex;\n        justify-content: center;\n        gap: 10px;\n        margin-bottom: 10px;\n    }\n    .timer-button {\n        padding: 8px 16px;\n        border: none;\n        border-radius: 4px;\n        cursor: pointer;\n        font-weight: bold;\n    }\n    .start {\n        background-color: var(--primary-color, #4CAF50);\n        color: var(--contrast-text-color, white);\n    }\n    .pause {\n        background-color: var(--secondary-color, #FFC107);\n        color: var(--text-color, #333);\n    }\n    .reset {\n        background-color: var(--accent-color, #F44336);\n        color: var(--contrast-text-color, white);\n    }\n    .timer-presets {\n        display: flex;\n        justify-content: center;\n        gap: 8px;\n    }\n    .preset-button {\n        padding: 5px 10px;\n        border: 1px solid var(--group-background-color, #ddd);\n        background-color: var(--all-background-color, #fff);\n        border-radius: 4px;\n        cursor: pointer;\n        color: var(--text-color, #333);\n    }\n    .timer-complete {\n        animation: pulse 0.5s alternate infinite;\n    }\n    @keyframes pulse {\n        from { background-color: var(--all-background-color, #fff); }\n        to { background-color: var(--accent-color, #ffcdd2); opacity: 0.7; }\n    }\n    ",document.head.appendChild(p)}function setupPomodoroWidget(e,t){e.innerHTML='\n        <div class="widget-placeholder">\n            <div class="widget-icon">🍅</div>\n            <div>Pomodoro Timer</div>\n            <div class="coming-soon">Coming soon</div>\n        </div>\n    '}function setupNewsWidget(e,t){e.innerHTML='\n        <div class="widget-placeholder">\n            <div class="widget-icon">📰</div>\n            <div>News Headlines</div>\n            <div class="coming-soon">Coming soon</div>\n        </div>\n    '}function setupStocksWidget(e,t){e.innerHTML='\n        <div class="widget-placeholder">\n            <div class="widget-icon">📈</div>\n            <div>Stocks</div>\n            <div class="coming-soon">Coming soon</div>\n        </div>\n    '}function setupRssWidget(e,t){e.innerHTML='\n        <div class="widget-placeholder">\n            <div class="widget-icon">📡</div>\n            <div>RSS Feed</div>\n            <div class="coming-soon">Coming soon</div>\n        </div>\n    '}function setupMusicWidget(e,t){e.innerHTML='\n        <div class="widget-placeholder">\n            <div class="widget-icon">🎵</div>\n            <div>Music Controls</div>\n            <div class="coming-soon">Coming soon</div>\n        </div>\n    '}function setupBookmarksWidget(e,t){e.innerHTML='\n        <div class="widget-placeholder">\n            <div class="widget-icon">🔖</div>\n            <div>Bookmarks</div>\n            <div class="coming-soon">Coming soon</div>\n        </div>\n    '}function setupRecentlyVisitedWidget(e,t){e.innerHTML='\n        <div class="widget-placeholder">\n            <div class="widget-icon">🕒</div>\n            <div>Recently Visited</div>\n            <div class="coming-soon">Coming soon</div>\n        </div>\n    '}const WIDGET_TEMPLATES={createWidget:createWidget},WIDGETS=[];